# Day 27 逻辑漏洞之支付逻辑的认识挖掘

**支付逻辑漏洞**

###### 负数加减支付

将数量处修改为-1

![image-20210804222140951](C:\Users\10637\AppData\Roaming\Typora\typora-user-images\image-20210804222140951.png)

![image-20210804222227990](C:\Users\10637\AppData\Roaming\Typora\typora-user-images\image-20210804222227990.png)

查看返回的数据包是否成功。

成功后可以观察页面状态，从而让后台数据输错，免单购买或者低价购买。

还可以通过购买多个商品，通过改包将购买整数与负数的商品相加，导致相互抵消，这样来操作最后付款的金额。

###### 商品金额可以被篡改

抓取数据包，对商品金额处进行修改，修改成自己想要的金额。提交数据包查看是否可以成功。

###### 运费+红包+优惠码

通过修改运费的金额，来实现低价购买商品；红包也是这种方式。

优惠码有两种，一种是多次使用优惠码，另一种是A的优惠码可一个给B使用。达到薅羊毛的目的。

###### 耗空库存导致他人无法下单

将库存全部购买，但是不结账。

###### 支付竞争漏洞

抓取数据包，使用自动化工具一瞬间向服务器多次请求付款的数据包，通过服务器后台程序数据库计算的时间差，从而实现一次购买的价钱购买多次。这种漏洞需要数据库加锁来进行解决。

